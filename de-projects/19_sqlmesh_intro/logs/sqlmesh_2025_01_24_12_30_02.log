2025-01-24 12:30:02,335 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:313)
2025-01-24 12:30:02,717 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:315)
2025-01-24 12:30:02,744 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:309)
2025-01-24 12:30:19,637 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:316)
2025-01-24 12:30:19,638 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2079)
2025-01-24 12:30:19,639 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2079)
2025-01-24 12:30:19,640 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__full_model__2278521865__temp', 'sqlmesh_example__incremental_model__772980299', 'sqlmesh_example__full_model__2278521865', 'sqlmesh_example__seed_model__2185867172') (base.py:2079)
2025-01-24 12:30:19,660 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:1044)
2025-01-24 12:30:19,660 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:2079)
2025-01-24 12:30:19,666 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__772980299' (evaluator.py:1349)
2025-01-24 12:30:19,666 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__772980299" ("id" INT, "item_id" INT, "new_column" TEXT, "event_date" DATE) (base.py:2079)
2025-01-24 12:30:19,667 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__772980299"."new_column" IS 'Added column' (base.py:2079)
2025-01-24 12:30:19,668 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.incremental_model' (evaluator.py:1371)
2025-01-24 12:30:19,669 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", 'z' AS "new_column", "seed_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2185867172" AS "seed_model" WHERE ("seed_model"."event_date" <= CAST('1970-01-01' AS DATE) AND "seed_model"."event_date" >= CAST('1970-01-01' AS DATE)) AND FALSE LIMIT 0 (base.py:2079)
2025-01-24 12:30:19,672 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__2278521865__temp' (evaluator.py:1349)
2025-01-24 12:30:19,672 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__2278521865__temp" ("item_id" INT, "num_orders" BIGINT) (base.py:2079)
2025-01-24 12:30:19,673 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.full_model' (evaluator.py:1371)
2025-01-24 12:30:19,673 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "incremental_model"."item_id" AS "item_id", COUNT(DISTINCT "incremental_model"."id") AS "num_orders" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__772980299" AS "incremental_model" WHERE FALSE GROUP BY "incremental_model"."item_id" LIMIT 0 (base.py:2079)
2025-01-24 12:30:19,695 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 3917826480> (evaluator.py:577)
2025-01-24 12:30:19,698 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2020-01-01 00:00:00, 2025-01-24 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__772980299' (evaluator.py:608)
2025-01-24 12:30:19,699 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__772980299" WHERE "event_date" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2025-01-23' AS DATE) (base.py:2079)
2025-01-24 12:30:19,700 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__772980299" ("id", "item_id", "new_column", "event_date") SELECT "id", "item_id", "new_column", "event_date" FROM (SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", 'z' AS "new_column", "seed_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2185867172" AS "seed_model" WHERE "seed_model"."event_date" <= CAST('2025-01-23' AS DATE) AND "seed_model"."event_date" >= CAST('2020-01-01' AS DATE)) AS "_subquery" WHERE "event_date" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2025-01-23' AS DATE) (base.py:2079)
2025-01-24 12:30:19,723 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (2020-01-01 00:00:00, 2025-01-24 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 3917826480> (engine_adapter.py:1031)
2025-01-24 12:30:19,729 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Promoting environment 'prod' (engine_adapter.py:280)
2025-01-24 12:30:19,736 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__2278521865" (base.py:2079)
2025-01-24 12:30:19,736 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Migrating table schema from 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__2278521865__temp' to 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__2278521865' (evaluator.py:852)
2025-01-24 12:30:19,736 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Altering table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__2278521865' (evaluator.py:1395)
2025-01-24 12:30:19,737 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__2278521865" (base.py:2079)
2025-01-24 12:30:19,737 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__2278521865__temp" (base.py:2079)
2025-01-24 12:30:19,738 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Pausing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 532112479> (engine_adapter.py:486)
2025-01-24 12:30:19,738 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2623132117> (engine_adapter.py:457)
2025-01-24 12:30:19,738 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 3917826480> (engine_adapter.py:457)
2025-01-24 12:30:19,740 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example' (evaluator.py:1044)
2025-01-24 12:30:19,740 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example" (base.py:2079)
2025-01-24 12:30:19,741 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.incremental_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__772980299' (evaluator.py:1315)
2025-01-24 12:30:19,741 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."incremental_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__772980299" (base.py:2079)
2025-01-24 12:30:19,741 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."sqlmesh_example"."incremental_model"."new_column" IS 'Added column' (base.py:2079)
2025-01-24 12:30:19,742 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.full_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__2278521865' (evaluator.py:1315)
2025-01-24 12:30:19,742 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."full_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__2278521865" (base.py:2079)
2025-01-24 12:30:19,743 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Finalizing environment 'prod' (engine_adapter.py:405)
2025-01-24 12:30:19,755 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
